# Generated from:
# https://github.com/plone/meta/tree/main/src/plone/meta/default
# See the inline comments on how to expand/tweak this configuration file
[meta]
template = "default"
commit-id = "2.2.2"

[pre_commit]
codespell_extra_lines = """
        exclude: docs/locale/.*.pot
"""
extra_lines = """
-   repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.18.2
    hooks:
    -   id: mypy
        additional_dependencies:
            - types-decorator
        exclude: docs
"""

[pyproject]
check_manifest_ignores = """
    # From `.meta.toml`, pyproject.check_manifest_ignores.
    "*.cfg",
    ".editorconfig",
    ".readthedocs.yaml",
    "constraints_plone62.txt",
    "constraints.txt",
    "fix-converted-myst.py",
    "Makefile",
    "requirements-docs.txt",
    "requirements.txt",
"""
dependencies_ignores = "['Products.PrintingMailHost', 'plone.app.iterate',]"
codespell_ignores = "manuel,checkin"

[tox]
test_matrix = {"6.2" = ["*"]}
envlist_lines = """
    linkcheck
    plone6docs
    docs
"""
config_lines = """
skip_missing_interpreters = True
"""
extra_lines = """
[testenv:plone6docs]
# New docs with plone-sphinx-theme
# See [testenv:docs] for classic documentation
basepython = python3.11
skip_install = False
constrain_package_deps = True
package = editable
allowlist_externals =
    mkdir
extras =
    tests
deps =
    -r requirements-docs.txt
commands =
    python -VV
    mkdir -p {toxinidir}/_build/plone6docs
    sphinx-build -b html -d _build/plone6docs/doctrees docs _build/plone6docs/html

[testenv:rtd-preview]
# Build docs on Read the Docs to preview pull requests using plone-sphinx-theme
basepython = python3.11
skip_install = False
constrain_package_deps = True
extras =
    tests
deps =
    -r requirements-docs.txt
commands =
    python -VV
    sphinx-build -b html -d "{env:READTHEDOCS_OUTPUT}"/doctrees/ docs "{env:READTHEDOCS_OUTPUT}"/html/

[testenv:docs]
basepython = python3.11
skip_install = False
usedevelop = True
allowlist_externals =
    mkdir
extras =
    tests

deps =
    -r requirements-docs.txt

commands =
    python -VV
    mkdir -p {toxinidir}/_build/docs
    sphinx-build -b html -D html_theme=alabaster -d _build/docs/doctrees docs _build/docs/html

whitelist_externals =
    mkdir

[testenv:linkcheck]
basepython = python3.11
skip_install = False
constrain_package_deps = True
package = editable
allowlist_externals =
    mkdir
extras =
    {[testenv:plone6docs]extras}
deps =
    {[testenv:plone6docs]deps}
commands =
    python -VV
    mkdir -p {toxinidir}/_build/plone6docs
    sphinx-build -b linkcheck -d _build/plone6docs/doctrees docs _build/plone6docs/linkcheck

[testenv:livehtml]
basepython = python3.11
skip_install = False
constrain_package_deps = True
package = editable
allowlist_externals =
    mkdir
extras =
    {[testenv:plone6docs]extras}
deps =
    {[testenv:plone6docs]deps}
commands =
    python -VV
    mkdir -p {toxinidir}/_build/plone6docs
    sphinx-autobuild -b html -d _build/plone6docs/doctrees docs _build/plone6docs/html
"""
