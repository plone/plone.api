# Generated from:
# https://github.com/plone/meta/tree/master/config/default
[meta]
template = "default"
commit-id = "54c96fb5"

[editorconfig]
extra_lines = """
[*.bat]
indent_style = tab
end_of_line = crlf

[LICENSE]
insert_final_newline = false"""

[setup]
check_manifest_ignore = """
    *.cfg
    constraints_plone52.txt
    constraints_plone60.txt
    constraints.txt
    fix-converted-myst.py
    Makefile
    netlify.toml
    requirements-docs.txt
    requirements.txt"""
extra_lines = """
[coverage:run]
branch = True
source =
    src

omit =
    *.rst
    */doctests/*
    */tests/*

[coverage:report]
precision = 2
include = src
omit =
    *.rst
    */doctests/*
    */tests/*

[coverage:html]
directory = _build/coverage"""

[tox]
envlist_lines = """
    py{38,39}-plone{52}
    py{38,39}-plone{60}
    # towncrier
#    coverage-report
    linkcheck
    plone6docs
    docs"""
config_lines = "skip_missing_interpreters = True"
testenv_lines = "skip_install = True"
extra_lines = """
[gh-actions]
python =
    3.8: py38
    3.9: py39

[gh-actions:env]
PLONE =
    52: plone52
    60: plone60

commands =
    python -VV
    pip install -r requirements.txt
    pip list
    {envbindir}/buildout -c /{toxinidir}/{env:BUILDOUT_FILE} buildout:directory={envdir} buildout:develop={toxinidir} install test
    {envbindir}/buildout -c {toxinidir}/{env:BUILDOUT_FILE} buildout:directory={envdir} buildout:develop={toxinidir} annotate
    {envbindir}/test

setenv =
    BUILDOUT_FILE=test_plone-60.cfg
    plone52: BUILDOUT_FILE=test_plone-52.cfg

deps =
    pdbpp
    manuel

[testenv:coverage-report]
basepython = python3.9
deps = coverage

setenv =
    COVERAGE_FILE=.coverage

skip_install = True

commands =
    python -VV
    coverage erase
    coverage combine
    coverage report
    coverage html
    coverage xml

[testenv:plone6docs]
# New docs with sphinx-book-theme
# See [testenv:docs] for classic documentation
basepython = python3.9
skip_install = False
usedevelop = True
extras =
    tests

deps =
    -r requirements-docs.txt

commands =
    python -VV
    mkdir -p {toxinidir}/_build/plone6docs
    sphinx-build -b html -d _build/plone6docs/doctrees docs _build/plone6docs/html

allowlist_externals =
    mkdir


[testenv:docs]
basepython = python3.9
skip_install = False
usedevelop = True
extras =
    tests

deps =
    -r requirements-docs.txt

commands =
    python -VV
    mkdir -p {toxinidir}/_build/docs
    sphinx-build -b html -D html_theme=alabaster -d _build/docs/doctrees docs _build/docs/html

allowlist_externals =
    mkdir


[testenv:linkcheck]
basepython = python
skip_install = False
usedevelop = True
extras =
    {[testenv:plone6docs]extras}
deps =
    {[testenv:plone6docs]deps}
commands =
    python -VV
    mkdir -p {toxinidir}/_build/plone6docs
    sphinx-build -b linkcheck -d _build/plone6docs/doctrees docs _build/plone6docs/linkcheck
allowlist_externals =
    mkdir


[testenv:towncrier]
basepython = python
skip_install = True

deps=
    towncrier

commands =
    towncrier --draft"""

[pre_commit]
codespell_extra_lines = "        exclude: .*\\.po(t)*$"
